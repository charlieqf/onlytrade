# PeerHub：通用 AI Agent 互动直播底座架构

为了使平台能够轻松复用于任何“AI Agent 直播+互动”场景（如游戏、新闻、社交、运动），我们需要采用**高度解耦的模块化信号-响应架构**。

## 1. 三层抽象设计

### I. 信号层 (Signal Layer - “眼睛”)
将数据源与 Agent 逻辑彻底分离。Agent 不需要知道它在看“股票价格”，它只接收通用的 `SignalPacket`（信号包）。
- **财经模块**：信号是股价、成交量、研报。
- **游戏模块**：信号是血量、地图位置、击杀信息。
- **社交模块**：信号是热搜话题、新增粉丝、被提及的内容。

### II. 核心 Agent 层 (Agent Layer - “大脑”)
Agent 的逻辑是一个纯函数或状态机。
- **输入**：`当前状态` + `最新信号` + `用户互动指令`。
- **输出**：`想法` (文本) + `行动` (交易/游戏操作) + `情感趋势` (视觉状态)。

### III. 表现层 (Expression Layer - “脸”)
UI 界面是一个通用的容器，支持针对不同场景的插件化展示。
- **组件化直播间**：一个标准模板，包含 `视频/图像区` + `聊天日志区` + `信号看板` (通用的可视化组件)。

## 2. 通用数据模式 (Supabase/Postgres)

- `Sessions`: 统一的直播会话表，支持任何类型的场景。
- `Signals`: 使用 JSONB 字段存储任意类型的信号数据。
- `AgentPersona`: 存储系统提示词 (Prompts)、视觉资产（头像/图片）和语音配置。
- `Interactions`: 标准化的“用户意图”表（打赏、投票、提问）。

## 3. 通用化实施方案

1.  **统一通讯协议**：定义标准 JSON 格式。Python 后端将所有外部输入视为“消息簇”。
2.  **插件化 Worker (Python)**：采用插件架构，你可以像换衣服一样把 `StockTraderWorker` 换成 `MinecraftPlayerWorker`，而无需改动核心调度逻辑。
3.  **适配性 UI (Next.js)**：根据 `session_type` 元数据自动切换前端组件（例如：股票场景显示 K 线，游戏场景显示地图统计）。

---

## 4. 潜在应用场景
- **AI 游戏实况**：Agent 在 Minecraft 或网游中冒险，根据观众指令改变游戏策略。
- **AI 币圈大佬**：专门针对 Web3/Memecoin 的混沌市场进行点评。
- **AI 实时评论员**：针对全球突发新闻或体育赛事进行实时逻辑复盘。
- **AI 地牢师 (DM)**：带领全场观众进行一场实时的、互动式的 D&D 跑团游戏。
